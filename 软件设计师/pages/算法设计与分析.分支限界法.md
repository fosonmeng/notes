title:: 算法设计与分析/分支限界法
alias:: 分支限界法

- 分支限界法类似于回溯法，也是一种在问题的解空间树T上搜索问题解的算法。但在一般情况下，分支限界法与回溯法的求解目标不同。回溯法的求解目标是找出T中满足约束条件的解中找出使某一目标函数值达到极大或极小的解，即在某种意义下的最优解。
- 由于求解目标不同，导致分支限界法与回溯法在解空间树T上的搜索方式也不相同。回溯法以深度优先的方式搜索解空间树T，而分支限界法则以广度优先或以最小耗费优先的方式搜索解空间树T。分支限界法的搜索策略是每一个活节点只有一次机会成为扩展节点。活节点一旦成为扩展节点，就一次性产生其所有儿子节点。在这些儿子节点中，那些导致不可行解或非最优解的儿子节点被舍弃，其余儿子节点被加入活节点表中。此后，从活节点表中取下一节点成为当前扩展节点，并重复上述节点扩展过程。这个过程一直持续到找到所需的解或活节点表为空时为止。人们已经利用分支限界法解决了大量离散最优化的实际问题。
- 与回溯法相似，限界函数的设计是分支限界法的一个核心问题，也是一个很难的问题。如何设计好限界函数来有效地减小搜索空间是应用分支限界法要考虑的问题。
- 从活节点表中选择下一扩展节点的不同方式导致不同的分支限界法。最常用的有以下两种。
	- 队列式(FIFO)分支限界法。队列式分支限界法将活节点表组织成一个队列，并按队列的先进先出原则选择下一个节点作为扩展节点。
	- 优先队列式分支限界法。优先队列式分支限界法将活节点表组织成一个优先队列，并按优先队列中规定的节点优先级选取优先级最高的下一个节点作为扩展节点。
- 优先队列中规定的节点优先级通常用一个与该节点相关的数值p来表示。节点优先级的高低与p值的大小相关。最大优先队列规定p值较大的节点优先级较高。在算法实现时，通常用一个最大堆来实现最大优先队列，用最大堆的Deletemax运算抽取堆中下一个节点成为当前扩展节点。类似地，最小优先队列规定p值较小的节点优先级较高。在算法实现时，常用一个最小堆来实现最小优先队列，用最小堆的Deletemin运算抽取堆中下一个节点成为当前扩展节点。
- 例如，n=3时0-1背包问题的一个实例：w=[16,15,15]，p=[45,25,25]，c=30，其解空间树如图9-7所示。
- 用队列式分支限界法解此问题时，用一个队列来存储活节点表。算法从根节点A出发。
  > 1. 初始时活节点队列为空。
  > 2. 节点A是当前扩展节点，它的两个儿子节点B和C均可谓可行节点，故将这两个儿子节点按照从左到右的顺序加入活节点队列，并且舍弃当前扩展节点A。
  > 3. 按照先进先出的原则，下一个扩展节点是活节点队列的队首节点B。扩展节点B得到其儿子节点D和E。由于D是不可行节点，故被舍去。E是可行节点，被加入活节点队列。此时活节点队列中的元素是C和E。
  > 4. C成为当前扩展节点，它的两个儿子节点F和G均为可行节点，因此被加入活节点队列。此时活节点队列中的元素是E、F、G。
  > 5. 扩展下一个节点E，得到节点J和K。J是不可行节点，因而被舍去。K是一个可行的叶节点，表示所求问题的一个可行解，其价值为45。此时活节点队列中的元素是F和G。
  > 6. 当前活节点队列的队首节点F成为下一个扩展节点。它的两个儿子节点L和M均为叶节点。L表示获得价值为50的可行解，M表示获得价值为25的可行解。
  > 7. G是最后一个扩展节点，其儿子节点N和O均为可行叶节点。最后活节点队列为空。