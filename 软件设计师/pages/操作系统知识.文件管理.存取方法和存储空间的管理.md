filters:: {"索引" false}
title:: 操作系统知识/文件管理/存取方法和存储空间的管理
alias:: 存取方法和存储空间的管理

- ## 文件的存取方法
	- 文件的存取方法是指读/写文件存储器上的一个物理块的方法，通常有顺序存取和随机存取两种方法。**顺序存取方法**是指对文件中的信息按顺序依次读/写；**随机存取方法**是指对文件中的信息可以按任意的次序随机地读写。
	- ### _顺序存取法_
	  collapsed:: true
		- 在提供记录式文件结构的系统中，顺序存取法就是严格按物理记录排列的顺序依次读取。如果当前读取的是Ri记录，下一次要读取的记录自动地确定为Ri+1。在只提供无结构的流式文件中，顺序存取法是按读写的位移（offset）从当前位置开始读写，每读完一段信息，读写位移自动加上这段信息的长度，以便读下一段信息。
	- ### _直接存取法_
	  collapsed:: true
		- 直接存取法允许用户随意存取文件中任意一个物理记录。对于无结构的流式文件，采用直接存取法，必须事先将读写偏移移动到待读写信息的位置上，然后再进行读写。
	- ### _按键存取法_
	  collapsed:: true
		- 按键存取法是直接存取法的一种，它不是根据记录的编号或地址来存取文件中的记录，而是根据文件中各记录的某个数据项内容来存取记录的，这种数据项称之为“**键**”。
- ## 文件存储空间的管理
	- 要将文件保存到外部存储器（简称外存或辅存）上首先必须知道存储空间的使用情况，即哪些物理块是被“占用”，哪些是“空闲”。特别是对大容量的磁盘存储空间被多用户共享时，用户执行程序经常要在磁盘上存储文件和删除文件，因此，文件系统必须对磁盘空间进行管理。外存空闲空间管理的数据结构通常称为**磁盘分配表**（Disk Allocation Table）。常用的空闲空间的管理方法有空闲区表、位示图、空闲块链和成组链接法4种。
	- ### 空闲区表
		- 将外存空间上的一个连续的未分配区域称为“空闲区”。操作系统为磁盘外存上所有空闲区建立一张空闲表，每个表项对应一个空闲区，空闲表中包含序号、空闲区的第一个块号、空闲块的块数和状态等信息。它适用于==连续文件结构== ((6264ec6d-aed7-4516-97fe-6f6fd33e55ba)) 。
		- ![image.png](../assets/image_1648980002676_0.png)
	- ### 位示图
		- 这种方法是在外存上建立一张位示图（bitmap），记录文件存储器的使用情况。每一位对应文件存储器上的一个物理块，取值0和1分别表示空闲和占用。文件存储器上的物理块依次编号为0、1、2、…。假如系统中==字长==为32位，那么在位示图中的第一个字对应文件存储器上的0、1、2、…、31号物理块；第二个字对应文件存储器上的32、33、34、…、63号物理块，依此类推。
		- 这种方法的主要特点是位示图的大小由磁盘空间的大小（物理块总数）决定，位示图的描述能力强，适合各种物理结构。
	- ### 空闲块链
		- 每个空闲物理块中有指向下一个空闲物理块的指针，所有空闲物理块构成一个链表，链表的==头指针==放在文件存储器的特定位置上（如管理块中）。不需要磁盘分配表，节省空间。每次申请空闲物理块只需根据链表的头指针取出第一个空闲物理块，根据第一个空闲物理块的指针可找到第二个空闲物理块，依此类推即可。
	- ### 成组链接法
		- 在UNIX系统中，系统将空闲块分成若干组，每100个空闲块为 ==1 组==，每组的第一个空闲块登记了下一组空闲块的物理盘块号和空闲块总数。假如某个组的第一个空闲块号等于0，意味着该组是最后一级，无下一组空闲块。